

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Streaming Processing &mdash; Scipion 2.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../static/documentation_options.js"></script>
        <script type="text/javascript" src="../../static/jquery.js"></script>
        <script type="text/javascript" src="../../static/underscore.js"></script>
        <script type="text/javascript" src="../../static/doctools.js"></script>
        <script type="text/javascript" src="../../static/language_data.js"></script>
    
    <script type="text/javascript" src="../../static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pyworkflow package" href="../../api/pyworkflow.html" />
    <link rel="prev" title="Tutorial" href="facilities-tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scipion-modes/how-to-install.html">Installing Scipion v2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scipion-modes/host-configuration.html">Host configuration</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/user-documentation.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/user-documentation.html#graphical-interface-manuals">Graphical interface manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/user-documentation.html#processing-how-to-s">Processing How To’s</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption"><span class="caption-text">Facilities</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="facilities-tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Streaming Processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#for-facilities">For facilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Streaming processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launching-the-demo">Launching the demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kicking-off-scipion-in-your-pipeline">Kicking off scipion in your pipeline</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/pyworkflow.html">pyworkflow package</a></li>
</ul>
<p class="caption"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/contact-us.html">Contact Us</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Streaming Processing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../sources/docs/facilities/facilities.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="streaming-processing">
<span id="facilities"></span><h1>Streaming Processing<a class="headerlink" href="#streaming-processing" title="Permalink to this headline">¶</a></h1>
<div class="section" id="for-facilities">
<h2>For facilities<a class="headerlink" href="#for-facilities" title="Permalink to this headline">¶</a></h2>
<p>When we develop these functionalities we are thinking about facilities.
Currently, scipion is being used every day in several facilities in Europe,
and more are joining from US and Canada. If you are running a Cryo EM facility
and want more info, please link:Contact-Us[Contact us]. We will be happy to
help you run Scipion there.</p>
</div>
<div class="section" id="id1">
<h2>Streaming processing<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>In the last months, we have been working on an extension of Scipion to process
data in streaming, i.e, at the same time movies (or micrographs) are coming
from the microscope PC. This allows to overlap computing time with the
acquisition (reducing computational needs) and also to detect problems at
early stages. This idea is implemented in different labs mainly by using
custom-made scripts. The advantage of our Scipion solution is that you have
the usual flexibility to choose what operations to do and the traceability to
re-do some of the steps later. It is basically the same Scipion interface with
one key change: the output is produced as soon as the first element is
available, and it is later updated with new output elements. This allows
concatenating several operations before the first one is completed.</p>
<p>On top of that, we have added the concept of monitors, the special protocols
that constantly check how the execution of other protocols is going. We have
developed several GUIs that are refreshed periodically and produce a graphical
summary (e.g, CTF defocus values, system load etc). A summary is also generated
in HTML format that can be easily copied to a public website to provide access
for external users. See an example <a class="reference external" href="http://scipion.cnb.csic.es/scipionbox/lastHTMLReport/">here</a>.</p>
</div>
<div class="section" id="launching-the-demo">
<h2>Launching the demo<a class="headerlink" href="#launching-the-demo" title="Permalink to this headline">¶</a></h2>
<p><em>NOTE: This information is only available since v1.2-Caligula version.</em></p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>To run the demo as it is, you need to have installed:</p>
<ul class="simple">
<li>scipion-em-motioncorr</li>
<li>scipion-em-grigoriefflab</li>
<li>scipion-em-eman</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scipion installp -p scipion-em-motioncorr -p scipion-em-grigoriefflab scipion-em-eman2
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Notice</span> <span class="pre">that</span> <span class="pre">motioncor2</span> <span class="pre">needs</span> <span class="pre">GPU</span> <span class="pre">acceleration.</span></code></p>
<p>In addition, the demo use either the jmbFalconMovies dataset for v1.2-Caligula version or the relion13_tutorial dataset for later versions (also for devel branch). Thus, you can download the dataset that you need by</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scipion testdata --download jmbFalconMovies relion13_tutorial
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>After installing all the requirements you just have to run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scipion demo
</pre></div>
</div>
<p>This will pop up a small wizard like the one below ready to go.</p>
<div class="figure align-center">
<img alt="Cryo EM Streaming demo wizard" src="https://user-images.githubusercontent.com/785633/33311258-87304f44-d424-11e7-844a-8360708fa7ed.png" />
</div>
<p>You can leave all the displayed data untouched since it goes right with the test data. Once you click on the “Start demo” button scipion should appear with the new project loaded running in streaming mode:</p>
<div class="figure align-center">
<img alt="Cryo EM workflow in streaming" src="https://user-images.githubusercontent.com/785633/32671892-61e856fc-c649-11e7-88bf-a161e2f3e2d1.png" />
</div>
<p>Import is already importing files and the rest are scheduled. As soon as there is any input available, the protocols will start processing it and making it available for the next protocol in line.</p>
<p>The “Monitor summary” is monitoring the progress and generating an HTML report with the outcome of the data.</p>
<p>To see the HTML summary report from Scipion you must first select (click) on the Summary monitor box, and once it is selected, click on the “Analyze result” button (down-right). A window like this will pop up:</p>
<div class="figure align-center">
<img alt="Summary monitor results window" src="https://user-images.githubusercontent.com/785633/33026513-e0c59966-ce10-11e7-9850-2a4bda805247.png" />
</div>
<p>Then click on the “Open HTML report” button. A browser will show you something like (link:http://scipion.cnb.csic.es/scipionbox/lastHTMLReport/[this])</p>
</div>
<div class="section" id="kicking-off-scipion-in-your-pipeline">
<h2>Kicking off scipion in your pipeline<a class="headerlink" href="#kicking-off-scipion-in-your-pipeline" title="Permalink to this headline">¶</a></h2>
<p>There are a couple of useful scripts that might be useful to start scipion right after the acquisition has started. In summary, you may want to somehow follow this steps:</p>
<ol class="arabic">
<li><p class="first">Ask for some basic input: In our experience, so far, there is still the need of asking the user/microscopist for some basic data before Kicking off scipion. This is the case for sampling rate, or dose or even based on the flexibiliy you want to offer in your pipeline many other options like “use Gctf” or “use CTFfind4” or both….this is really up to you and Scipion does not implement any of this.
The mechanism to ask for is not part of scipion, although there are some sample scripts that could be useful as an staring point, but we doubt that will be perfect as they are for your case. You will need to adapt them to your needs. The demo script (scripts/scipionbox_wizard_demo.py) might be the simplest one and does not require any config file, but it is very tied to demo purposes. Other scripts are similar to real scripts used in facilities, like (scripts/cipionbox_wizard_scilifelab.py) and are based on TK GUI. In some other facilities, the have a webserver eith an HTML form to request for this data. It is really up to your pipeline design. Alternatively, it can be done by modifying some fields of an existing JSON template in order to launch a form to be filled by the user. The syntax to replace a static field to a form field is as follow: replace any value of the JSON file by</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>~label<span class="p">|</span>defaultValue<span class="p">|</span>typeValue~
</pre></div>
</div>
</div></blockquote>
<p>where ‘label’ is what will be shown in the form, ‘defaultValue’ will be the default value and ‘typeValue’ is an integer fixing the type of the value (0 for a string, 1 for a path, 2 for a boolean, 3 for an integer, and 4 for a float). Then, the form can be launched by</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scipion python scripts/scipionbox_preprocess_basic.py path/to/workflow.json
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Create the project using the input: the second step would be to use those values captured and create a scipion project accordingly. In this case you have 2 options:</p>
<ul>
<li><p class="first"><em>A</em>.- Use SCIPION as an API to create the project following your pipeline design. This is the case for: <a class="reference external" href="https://github.com/delarosatrevin/scipion-session">https://github.com/delarosatrevin/scipion-session</a> or <a class="reference external" href="https://github.com/azazellochg/scipion-session-lmb">https://github.com/azazellochg/scipion-session-lmb</a></p>
</li>
<li><p class="first"><em>B</em>.- Generate a “json” file, usually based on a template, that will be completed with the data requested in the previous step. This is the case of the demo script(scripts/scipionbox_wizard_demo.py). Is in this case that, once you have your “workflow.json” you can run a script to create the project based on that workflow like:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scipion python scripts/create_project.py <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;session1234&quot;</span> <span class="nv">workflow</span><span class="o">=</span><span class="s2">&quot;path/to/your/workflow.json&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</li>
<li><p class="first">The final step would be to “Start” all protocols to kick off the processing: For the <em>B</em> case, there is another script that will do that:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scipion python scripts/schedule_project.py <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;session1234&quot;</span>+
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>If using scipion as an API, you may want to Start the protocols at the same step (<em>A</em> case)</p>
<p>After this, you will have Scipion up and running actively looking for new acquisitions and following the steps in your customized workflow.</p>
<p>If you look for inspiration, you can find workflow examples in the scipion workflows repository: <a class="reference external" href="http://workflows.scipion.i2pc.es/">http://workflows.scipion.i2pc.es/</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../api/pyworkflow.html" class="btn btn-neutral float-right" title="pyworkflow package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="facilities-tutorial.html" class="btn btn-neutral float-left" title="Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: release-2.0.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="facilities.html">release-2.0.0</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>