

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Acquisition simulation project for the ISC course &mdash; Scipion 2.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../static/documentation_options.js"></script>
        <script type="text/javascript" src="../../static/jquery.js"></script>
        <script type="text/javascript" src="../../static/underscore.js"></script>
        <script type="text/javascript" src="../../static/doctools.js"></script>
        <script type="text/javascript" src="../../static/language_data.js"></script>
    
    <script type="text/javascript" src="../../static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scipion-modes/how-to-install.html">How to install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scipion-modes/host-configuration.html">Host configuration</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/user-documentation.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/user-documentation.html#graphical-interface-manuals">Graphical interface manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/user-documentation.html#processing-how-to-s">Processing How To’s</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="facilities-tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="facilities.html">Streaming Processing</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/pyworkflow.html">pyworkflow package</a></li>
</ul>
<p class="caption"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/contact-us.html">Contact Us</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Acquisition simulation project for the ISC course</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../sources/docs/facilities/acquisition_simulation_project_for_the _ISC _course.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="acquisition-simulation-project-for-the-isc-course">
<span id="id1"></span><h1>Acquisition simulation project for the ISC course<a class="headerlink" href="#acquisition-simulation-project-for-the-isc-course" title="Permalink to this headline">¶</a></h1>
<div class="section" id="acquisition-simulation-demo">
<h2>Acquisition simulation demo<a class="headerlink" href="#acquisition-simulation-demo" title="Permalink to this headline">¶</a></h2>
<p>In order to simulate a cryo-em acquisition we will run an script that, firstly, it takes movies from a data set, one by one every minute, to deposit it to the <code class="docutils literal notranslate"><span class="pre">~/microDepositions</span></code> folder and, secondly, it launches a Scipion pre-processing workflow to analyze the acquisition simulation in that folder.</p>
<p>To do that, double click to the shortcut ‘Acquisition Demo’ or, alternatively, go to a terminal and run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="o">~/</span><span class="n">em</span><span class="o">-</span><span class="n">facilities</span><span class="o">/</span><span class="n">script</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>This will open a form to set up the preprocessing workflow.</p>
<p>All the parameters in the <code class="docutils literal notranslate"><span class="pre">Pre-processing</span></code> section are optional and the default values are fine enough for the demo data set. However you can play setting the parameters in some way. For instance:</p>
<blockquote>
<div><ul class="simple">
<li>We know that the sample belongs to the <code class="docutils literal notranslate"><span class="pre">d2</span></code> symmetry group and this will be used to estimate the initial model, however one can introduce any other symmetry group.</li>
<li>The movies have 16 frames, thus you cat skip some of them by indicating a certain <code class="docutils literal notranslate"><span class="pre">Frames</span> <span class="pre">range</span></code>.</li>
<li>The <strong>manual picking is skipped</strong> since we set an <code class="docutils literal notranslate"><span class="pre">estimated</span> <span class="pre">particle</span> <span class="pre">size</span></code> of <code class="docutils literal notranslate"><span class="pre">250</span></code> A, getting in this way a fully automatic workflow. However, if the estimated particle size is not know, a Manual picking is launched.</li>
<li>We can add optional protocols to estimate an initial volume such as <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">Ransac</span></code> and/or <cite>Eman Initial Volume</cite> then, if some is selected, the workflow will include the <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">swarm</span></code> protocol that finds a consensus initial volume. Note that <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">Significance</span></code> is always used to perform an initial model.</li>
</ul>
</div></blockquote>
<p>For the <strong>GPU usage</strong> section, if you are running an AWS machine, you can run any of GPU protocol. Note that since all the workflow will be running at the same time in parallel, only one GPU id can be attached to one protocol.
Alternatively, if you are running Scipion in a VirtualBox machine you are not able to use GPU acceleration, therefore remain all the GPU ids at <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p>
<p>Now, we are able to start the simulation acquisition by clicking on <strong>Create New Session</strong>.</p>
<p>A Scipion window should open, showing a project according to the parameters introduced in the form (it can take around 10s). A Scipion project is made of a tree of individual boxes that we call <code class="docutils literal notranslate"><span class="pre">protocols</span></code>. Every protocol performs a single operation such as align movies, estimate CTFs, pick particles…</p>
<p>This project is fully scheduled, so after a while, the <code class="docutils literal notranslate"><span class="pre">Import</span> <span class="pre">Movies</span></code> protocol will start to take movies and the data will flow down to the child protocols as it is ready to be processed.</p>
<p>The project is continuously changing as data is flowing, then Scipion automatically updates the status of every protocol periodically. However, you can manually update the whole project by clicking on <code class="docutils literal notranslate"><span class="pre">Refresh</span></code> at top-right corner.</p>
<p>After a while, some movies will be aligned. We can see how the aligned movies looks by clicking on the <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">-</span> <span class="pre">corr.</span> <span class="pre">align.</span></code> or <code class="docutils literal notranslate"><span class="pre">MotionCor2</span> <span class="pre">-</span> <span class="pre">align</span> <span class="pre">movies</span></code> protocol and then, clicking on the red button <code class="docutils literal notranslate"><span class="pre">Analyze</span> <span class="pre">Results</span></code>.</p>
<p>Afterwards, the CTF is estimated by two protocols (CTFfind4 and Xmipp) and, then, the <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">-</span> <span class="pre">CTF</span> <span class="pre">consensus</span></code> performs a CTF quality evaluation in 3 different ways:</p>
<blockquote>
<div><ul class="simple">
<li>General criteria: Asserts if the defocus is in a certain range and if the astigmatism and the estimated resolution is below a certain threshold.</li>
<li>Xmipp criteria: Asserts several quality values assigned by Xmipp</li>
<li>Consensus criteria: Compare the two CTF estimations and check their compatibility.</li>
</ul>
</div></blockquote>
<p>We can view the results of every protocol by clicking on it’s box and then, clicking on the red button <code class="docutils literal notranslate"><span class="pre">Analyze</span> <span class="pre">Results</span></code>. Also, Scipion has implemented a <code class="docutils literal notranslate"><span class="pre">Summary</span> <span class="pre">Monitor</span></code> protocol that creates a HTML report that summarize all the relevant parameters to follow the acquisition from any web browser. You can see it by clicking on the <code class="docutils literal notranslate"><span class="pre">Analyze</span> <span class="pre">Results</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Open</span> <span class="pre">HTM</span> <span class="pre">Report</span></code>.</p>
<p>At this point, if you fixed a particle size in the form, the <code class="docutils literal notranslate"><span class="pre">Eman</span> <span class="pre">-</span> <span class="pre">Sparx</span> <span class="pre">auto-pick</span></code> have automatically picked some particles.  Alternatively, if no particle size has provided, the <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">-</span> <span class="pre">manual-picking</span></code> is waiting to by launched. To launch it, <code class="docutils literal notranslate"><span class="pre">right-click</span></code> on the box and <code class="docutils literal notranslate"><span class="pre">Execute</span></code>. Now, two windows are opened, one showing a micrograph and other listing the available micrographs and some parameters. Please, set a particle box size to about <code class="docutils literal notranslate"><span class="pre">70</span></code> pixels and pick some particles on the micrograph. Then, you can <cite>Activate Training</cite> to pass to a semiautomatic mode where multiple particle are automatically picked and you can refine it by adding new particles clicking and/or deleting by <cite>shift+click</cite> on a box. Once you are happy with the picking, click <cite>+Coordinate</cite> to save the results. Then, execute the <cite>auto-picking</cite> and the <code class="docutils literal notranslate"><span class="pre">consensus</span> <span class="pre">pickings</span></code> protocols in order to continue with the workflow.</p>
<p>After extracting the particles, we perform a pruning to clean a bit the particles set following statistic analysis. Note that since the statistical analysis needs a certain among of particles, we include a trigger protocol that waits until a certain number of particles is reached to automatically continue with the workflow.</p>
<p>Since the 2D classifications protocols need a certain among of particles and a static input, the <cite>trigger data to classify</cite> waits until a certain number of particles is reach to release a closed set of particles to fed the classifiers.</p>
<p>Until here, the acquisition takes from 5 minutes to 10 minutes for the 10 demo movies. However, due to the limited resources that we have in VirtualBox, we are not able to continue with the classification and the initial model estimation in an optimal way (it will take 3-5 hours). However, we can open an already processed project to see how it would have continue. Therefore, close the project by clicking on the <code class="docutils literal notranslate"><span class="pre">Project</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Exit</span></code>.</p>
</div>
<div class="section" id="acquisition-simulation-project">
<h2>Acquisition simulation project<a class="headerlink" href="#acquisition-simulation-project" title="Permalink to this headline">¶</a></h2>
<p>To open the already processed project, launch Scipion from the shortcut and choose the ‘Acquisition_Simulation’ project, then a Scipion window should be opened showing the project.</p>
<p>In this project, we have labeled/colored the protocols by sections. You can change the color mode by <code class="docutils literal notranslate"><span class="pre">Project</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Toogle</span> <span class="pre">color</span> <span class="pre">mode</span></code> or <code class="docutils literal notranslate"><span class="pre">ctrl+t</span></code>. Even, you can add/edit labels clicking on <code class="docutils literal notranslate"><span class="pre">Project</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Manage</span> <span class="pre">project</span> <span class="pre">labels</span></code> or <code class="docutils literal notranslate"><span class="pre">right-click</span></code> on a protocol and click <code class="docutils literal notranslate"><span class="pre">labels</span></code> to attach a label to a protocol.</p>
<p>In this case, two particles picking have been used, the <code class="docutils literal notranslate"><span class="pre">Eman</span> <span class="pre">-</span> <span class="pre">Sparx</span> <span class="pre">auto-pick</span></code> and the <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">-</span> <span class="pre">manual-picking</span></code>. And two <code class="docutils literal notranslate"><span class="pre">consensus</span> <span class="pre">pickings</span></code> have been performed, one with the junction of the two pickings (OR) and other with all those particles that coincides in both pickers (AND).</p>
<p>Since the 2D-classifyers work with a static set of particles, the <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">-</span> <span class="pre">triger</span> <span class="pre">data</span> <span class="pre">to</span> <span class="pre">classify</span></code> ensures that a certain among of particles is ready and then, a closed set of particles is given to fed the classifiers. We have added two independent methods to classify, one from Relion and the other from Xmipp.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Auto-class</span> <span class="pre">selection</span></code> takes those averages that seems fine to be used to fed the initial model protocols. Then, the <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">-</span> <span class="pre">swarm</span> <span class="pre">init.</span> <span class="pre">vol.</span></code> performs a consensus between the <code class="docutils literal notranslate"><span class="pre">Eman</span> <span class="pre">-</span> <span class="pre">initial</span> <span class="pre">vol.</span></code>, <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">-</span> <span class="pre">Recons.</span> <span class="pre">significans</span></code> and <code class="docutils literal notranslate"><span class="pre">Xmipp</span> <span class="pre">-</span> <span class="pre">Ransac</span></code> to give an initial volume.</p>
<p>Finally, to keep monitoring the incoming particles coming from the new acquired movies, <code class="docutils literal notranslate"><span class="pre">Scipion</span> <span class="pre">-</span> <span class="pre">streamer</span></code> is launching several <code class="docutils literal notranslate"><span class="pre">Relion</span> <span class="pre">-</span> <span class="pre">2D</span> <span class="pre">classifying</span></code> in batches.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: release-2.0.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../release-2.0.0/docs/facilities/acquisition_simulation_project_for_the _ISC _course.html">release-2.0.0</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>